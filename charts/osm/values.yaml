# Default values for osm.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

OpenServiceMesh:
  # -- `osm-controller` replicas
  replicaCount: 1
  image:
    # -- `osm-controller` image registry
    registry: openservicemesh
    # -- `osm-controller` pod PullPolicy
    pullPolicy: IfNotPresent
    # -- `osm-controller` image tag
    tag: v0.8.3
  # -- `osm-controller` image pull secret
  imagePullSecrets: []
  # -- Envoy sidecar image
  sidecarImage: envoyproxy/envoy-alpine:v1.17.2
  osmcontroller:
    resource:
      limits:
        cpu: "1.5"
        memory: "512M"
      requests:
        cpu: "0.5"
        memory: "128M"
    podLabels: {}
  prometheus:
    # -- Resource limits for prometheus instance
    resources:
      limits:
        cpu: 1
        memory: 2G
      requests:
        cpu: 0.5
        memory: 512M
    # -- Prometheus port
    port: 7070
    retention:
      # -- Prometheus retention time
      time: 15d
  # -- The Certificate manager type: `tresor`, `vault` or `cert-manager`
  certificateManager: tresor
  vault:
    # --  Hashicorp Vault host/service - where Vault is installed
    host:
    # -- protocol to use to connect to Vault
    protocol: http
    # -- token that should be used to connect to Vault
    token:
    # -- Vault role to be used by Open Service Mesh
    role: openservicemesh
  certmanager:
    # --  cert-manager issuer namecert-manager issuer name
    issuerName: osm-ca
    # -- cert-manager issuer kind
    issuerKind: Issuer
    # -- cert-manager issuer group
    issuerGroup: cert-manager
  # -- The Kubernetes secret to store `ca.crt`
  caBundleSecretName: osm-ca-bundle
  grafana:
    # -- Grafana port
    port: 3000
    # -- Enable Remote Rendering in Grafana
    enableRemoteRendering: false
  # -- Deploy Prometheus
  deployPrometheus: false
  # -- Deploy Grafana
  deployGrafana: false
  # -- Enable Fluent Bit sidecar deployment
  enableFluentbit: false
  fluentBit:
    # -- Fluent Bit sidecar container name
    name: fluentbit-logger
    # -- Registry for Fluent Bit sidecar container
    registry: fluent
    # -- Fluent Bit sidecar image tag
    tag: 1.6.4
    # -- PullPolicy for Fluent Bit sidecar container
    pullPolicy: IfNotPresent
    # -- Fluent Bit output plugin
    outputPlugin: stdout
    # -- WorkspaceId for Fluent Bit output plugin to Log Analytics
    workspaceId: ""
    # -- Primary Key for Fluent Bit output plugin to Log Analytics
    primaryKey: ""
    # -- Enable proxy support toggle for Fluent Bit
    enableProxySupport: false
    # -- Optional HTTP proxy endpoint for Fluent Bit
    httpProxy: ""
    # -- Optional HTTPS proxy endpoint for Fluent Bit
    httpsProxy: ""
  # -- Name for the new control plane instance
  meshName: osm
  # -- Controller log verbosity
  controllerLogLevel: info
  # -- Enforce only deploying one mesh in the cluster
  enforceSingleMesh: false
  # -- Validating- and MutatingWebhookConfiguration name
  webhookConfigNamePrefix: osm-webhook

  # -- Optional parameter. If not specified, the release namespace is used to deploy the osm components.
  osmNamespace: ""

  # -- Deploy Jaeger in the OSM namespace
  deployJaeger: false

  # -- Sidecar injector configuration
  injector:
    replicaCount: 1
    resource:
      limits:
        cpu: "0.5"
        memory: "64M"
      requests:
        cpu: "0.3"
        memory: "64M"
    podLabels: {}
  # -- Feature flags for experimental features
  featureFlags:
    # Enable extra Envoy statistics generated by a custom WASM extension
    enableWASMStats: false

    # Enable OSM's Egress policy API
    # If specified, fine grained control over Egress (external) traffic is enforced
    enableEgressPolicy: false

